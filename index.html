<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Little Sheeeeep</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="CharlotteYang"><meta name="msapplication-TileImage" content="/img/logo.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="CharlotteYang"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Little Sheeeeep"><meta property="og:url" content="https://llragdoll.github.io/"><meta property="og:site_name" content="Little Sheeeeep"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://llragdoll.github.io/img/og_image.png"><meta property="article:author" content="Charlotte Yang"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://llragdoll.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://llragdoll.github.io"},"headline":"Little Sheeeeep","image":["https://llragdoll.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Charlotte Yang"},"publisher":{"@type":"Organization","name":"Little Sheeeeep","logo":{"@type":"ImageObject","url":"https://llragdoll.github.io/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Little Sheeeeep" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-25T07:47:05.000Z" title="2023/10/25 15:47:05">2023-10-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-10-25T10:18:55.829Z" title="2023/10/25 18:18:55">2023-10-25</time></span><span class="level-item">11 minutes read (About 1695 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/25/dataExamineLab/">dataExamineLab</a></p><div class="content"><h1 id="异步串联通信收发-奇偶数据校验实验"><a href="#异步串联通信收发-奇偶数据校验实验" class="headerlink" title="异步串联通信收发&amp;奇偶数据校验实验"></a>异步串联通信收发&amp;奇偶数据校验实验</h1><h5 id="实验时间：2023-10-20"><a href="#实验时间：2023-10-20" class="headerlink" title="实验时间：2023.10.20"></a>实验时间：2023.10.20</h5><h2 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h2><p>  实验目的旨在通过使用计算机的串行口，展示两台计算机之间字符的传输，深入解释通信的基本原理，并强调了物理层的作用。 链路层的数据校验是一种检测数据是否正确的方法，它可以提高数据通信的可靠性和质量。数据校验在链路层有重要的作用。奇偶校验是一种使用异步串行传输的数据校验方式，它可以通过改变奇偶校验参数来演示数据校验的效果。实验具体目的包括:</p>
<ol>
<li>理解异步串行通信原理</li>
<li>对RS-232通信标准和帧格式的熟悉</li>
<li>学习通信参数如波特率的作用和使用</li>
<li>学习和掌握奇偶校验的原理和方法</li>
<li>了解数据校验在数据通信中的意义和作用，加深对链路层功能的理解</li>
</ol></div><a class="article-more button is-small is-size-7" href="/2023/10/25/dataExamineLab/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-25T07:46:34.000Z" title="2023/10/25 15:46:34">2023-10-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-10-25T08:01:22.249Z" title="2023/10/25 16:01:22">2023-10-25</time></span><span class="level-item">7 minutes read (About 1097 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/25/EthernetLab/">EthernetLab</a></p><div class="content"><h1 id="以太网组网实验"><a href="#以太网组网实验" class="headerlink" title="以太网组网实验"></a>以太网组网实验</h1><h5 id="实验时间：2023-10-20"><a href="#实验时间：2023-10-20" class="headerlink" title="实验时间：2023.10.20"></a>实验时间：2023.10.20</h5><h2 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h2><p>​    物理网络是由多个节点连接起来的网络,是构成互联网的重要部分,可以互相传输数据。本实验使用以太网交换机来建立一个独立的物理网络，它使用双绞线作为传输介质。这个实验旨在观察和测试网络节点之间的通信情况。具体目的如下:</p>
<ol>
<li>了解局域网的组成和功能。</li>
<li>掌握以太网的配置和连接方法。</li>
<li>学习以太网的地址格式和规则。</li>
</ol>
<h2 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h2><ul>
<li><strong>以太网</strong>：以太网是一种常见的有线局域网技术，它广泛应用于家庭和企业的网络建设。无线网络也需要通过以太网来接入互联网。以太网主要包括以太网设备、以太网卡和双绞线三个部分。</li>
<li><strong>连接方式</strong>：要想加入以太网，主机必须有一块以太网卡，现在的计算机通常都内置了以太网卡。集线器和交换机是两种常用的以太网设备，它们都有多个以太网口，可以用双绞线把主机的网卡和设备的口连接起来，形成一个独立的物理网络，网络中的节点可以互相通信。</li>
</ul>
<p>​		双绞线以太网组网如下图所示:</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231021110503736.png" alt="image-20231021110503736" style="zoom:50%;" />


<h2 id="实验环境"><a href="#实验环境" class="headerlink" title="实验环境"></a>实验环境</h2><h4 id="实验地点："><a href="#实验地点：" class="headerlink" title="实验地点："></a>实验地点：</h4><p>​	济事楼330机房</p>
<h4 id="实验设备："><a href="#实验设备：" class="headerlink" title="实验设备："></a>实验设备：</h4><p>​	PC两台,交换机一台,双绞线两根</p>
<p>​	实验拓扑结构如下:</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231021110617144.png" alt="image-20231021110617144" style="zoom:50%;" />

<p>​	计算机Host1作为操作平台,Host2作为测试平台.</p>
<h2 id="实验内容"><a href="#实验内容" class="headerlink" title="实验内容"></a>实验内容</h2><ul>
<li><strong>建立以太网局域网</strong><ul>
<li>用双绞线把两台计算机的网卡和交换机的端口连起来，形成一个局域网。</li>
<li>给每台计算机的网卡分配一个IP地址，使用TCP&#x2F;IP协议进行通信。把子网掩码都设为255.255.255.0，把Host1的IP地址设为192.168.1.12，把Host2的IP地址设为192.168.1.10。</li>
<li>用ping命令来检查两台计算机是否能互相通信，如果能收到回应，就说明连通成功。</li>
</ul>
</li>
<li><strong>查看以太网网卡地址</strong>：用ipconfig命令来查看每台计算机的网卡物理地址，它是一个唯一的标识符，由六个十六进制数组成。</li>
</ul>
<h2 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h2><ol>
<li><p>用两根双绞线分别将两台计算机网卡同交换机端口连接起来,以形成局域网.</p>
<p><strong>注意检查交换机端口的指示灯是否亮起且为绿色,实验时我和同学因为交换机一直显示无法连接到主机</strong></p>
</li>
<li><p>为两台主机配置IP地址。将HostlP地址设为192.168.1.12，子网掩码为255.255.255.0 ;Host2IP地址设为192.168.1.10，子网掩码为255.255.255.0</p>
<p>在windows操作系统中,具体步骤为:</p>
<ul>
<li>在设置中选择网络,选择更改适配器设置;右击‘以太网’,选择属性,选择‘Internet协议版本4(TCP&#x2F;IPv4),点击属性</li>
<li>设置IP地址、子网掩码、默认网关,点击确认保存.</li>
</ul>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231022170308199.png" alt="image-20231022170308199" style="zoom: 33%;" />
</li>
<li><p>测试Host1和Host2是否连通。打开Hostl命令行窗口，输入ping Host2IP地址指令,可以看到来自Host2的回复.</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231022170345197.png" alt="image-20231022170345197" style="zoom: 50%;" />
</li>
<li><p>查看Host1的以太网物理地址.在命令行窗口中输入命令:<code>ipconfig /all</code>,能在输出中看到Host1的以太网IP地址和物理地址.</p>
</li>
</ol>
<h2 id="实验结论"><a href="#实验结论" class="headerlink" title="实验结论"></a>实验结论</h2><ol>
<li><p>在建立以太网局域网时，正确连接双绞线至计算机的网卡和交换机的端口是至关重要的，一定要检查,确保交换机端口指示灯显示正常，以维持网络正常运行.</p>
</li>
<li><p>配置IP地址和子网掩码是局域网通信的基本要求.确保每台计算机拥有唯一的IP地址，并且它们的子网掩码相同.</p>
</li>
<li><p>使用ping命令可以方便地测试两台计算机是否可以相互通信，也可以使用arp命令查看通信情况.</p>
</li>
<li><p>物理网络中的每个网络接口都有一个唯一的物理地址，通常由六个十六进制数表示。</p>
</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-25T07:44:58.000Z" title="2023/10/25 15:44:58">2023-10-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-10-25T08:01:14.185Z" title="2023/10/25 16:01:14">2023-10-25</time></span><span class="level-item">6 minutes read (About 943 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/25/UDPLab/">UDPLab</a></p><div class="content"><h1 id="UDP协议网络编程实验"><a href="#UDP协议网络编程实验" class="headerlink" title="UDP协议网络编程实验"></a>UDP协议网络编程实验</h1><h5 id="实验时间：2023-10-8"><a href="#实验时间：2023-10-8" class="headerlink" title="实验时间：2023.10.8"></a>实验时间：2023.10.8</h5><h2 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h2><p>本实验旨在利用Socket编写一个基于UDP协议的程序，实现即时通信。具体目标如下：</p>
<ol>
<li>学习Server&#x2F;Client模型，以及端口在网络通信中的重要作用；</li>
<li>掌握利用Socket编写基于UDP协议的程序的方法。</li>
<li>学习无连接通信方式，理解与面向连接的通信方式的区别。</li>
</ol>
<h2 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h2><p>UDP即时通信流程图如下：</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009154055192.png" alt="image-20231009154055192" style="zoom:50%;" />

<p>在流程图中，UDPClient类实现了客户机，UDPServer类实现了服务器。客户机通过端口号5555访问服务器，而客户机端口由系统自动赋予。<strong>实验时必须首先启动服务器。</strong>DatagramSocket类代表UDP数据对象，DatagramPacket类代表UDP协议对象，包含了代表UDP端口的两个属性。采用无连接服务，直接和对方进行通信，主要方法包括<code>send(DatagramPacket)和receive(DatagramPacket)</code>.</p>
<ol>
<li><p>UDPServer类</p>
<ul>
<li><p>创建Socket，创建时需提供端口号</p>
<p><code>DatagramSocket server=new DatagramSocket(5555);</code></p>
</li>
<li><p>创建UDP数据包缓存区,存放应用数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">byte</span>[] buffer=<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">101</span>];</span><br><span class="line">   <span class="keyword">private</span> DatagramPacket request;</span><br></pre></td></tr></table></figure>
</li>
<li><p>利用Socket收发数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server.receive(request);</span><br><span class="line">server.send(request);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>UDPClient类</p>
<ul>
<li><p>获取UDP服务器地址对象并且进行地址解析，从点分十进制IP地址或者域名获取服务器IP地址对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> InetAddress server;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">btnConnectActionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">serverIP</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			serverIP = <span class="built_in">this</span>.textFieldIP.getText();</span><br><span class="line">			server = InetAddress.getByName(serverIP);</span><br><span class="line">			...</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnknownHostException ue) &#123;</span><br><span class="line">			...</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建Socket对象，不需要提供端口号</p>
<p><code>DatagramSocket client=new DatagramSocket();</code></p>
</li>
<li><p>创建UDP数据包缓存区,存放应用数据,需要指定服务器地址和端口号</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> DatagramPacket request, response;</span><br><span class="line"><span class="keyword">private</span> <span class="type">byte</span>[] bufferSended;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">btnSendActionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			bufferSended = <span class="built_in">this</span>.textMessage.getText().getBytes();</span><br><span class="line">			client = <span class="keyword">new</span> <span class="title class_">DatagramSocket</span>();<span class="comment">// client</span></span><br><span class="line">			request = <span class="keyword">new</span> <span class="title class_">DatagramPacket</span>(bufferSended, bufferSended.length,</span><br><span class="line">					server, <span class="number">5555</span>);</span><br><span class="line">			...</span><br><span class="line">		&#125; ...</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>利用Socket收发数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// send发送数据</span></span><br><span class="line">client.send(request);   </span><br><span class="line"><span class="built_in">this</span>.textMessage.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="comment">// receive</span></span><br><span class="line">client.receive(response);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="实验环境"><a href="#实验环境" class="headerlink" title="实验环境"></a>实验环境</h2><h4 id="实验地点："><a href="#实验地点：" class="headerlink" title="实验地点："></a>实验地点：</h4><p>​	济事楼330机房</p>
<h4 id="实验设备："><a href="#实验设备：" class="headerlink" title="实验设备："></a>实验设备：</h4><p>​	PC一台，IntelliJ IDEA IDE</p>
<h2 id="实验内容"><a href="#实验内容" class="headerlink" title="实验内容"></a>实验内容</h2><ol>
<li>实现客户端和服务端编程，即UDPClient类和UDPServer两个类</li>
<li>进行实时通信测试交互。先运行UDPServer类，再运行UDPClient类，然后在客户端界面中输入要发送的字符串信息，在服务端观察接收，实现即时通信。</li>
</ol>
<h2 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h2><p>运行IntelliJ IDEA，创建Socket项目。</p>
<ol>
<li><p>在main&#x2F;src&#x2F;java下创建软件包<code>edu.tongji.networklab.udp</code></p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009161225802.png" alt="image-20231009161225802" style="zoom: 33%;" />

<ol start="2">
<li>在软件包中创建Java类<code>UdpClient</code></li>
</ol>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009161444414.png" alt="image-20231009161444414" style="zoom:33%;" />

<ol start="3">
<li><p>输入UdpClient类代码，用服务器下文件完全覆盖并保存编译。</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009161941539.png" alt="image-20231009161941539" style="zoom:33%;" />
</li>
<li><p>重复2和3步骤，创建Java类<code>UdpServer</code></p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009161913274.png" alt="image-20231009161913274" style="zoom:33%;" />
</li>
<li><p>运行代码，进行UDP协议下的即时通信</p>
<ul>
<li><p>运行UdpServer类<strong>（必须先于UdpClient类运行）</strong>点击右上角运行按钮</p>
</li>
<li><img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009162243899.png" alt="image-20231009162243899" style="zoom: 33%;" />

<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009162407909.png" alt="image-20231009162407909" style="zoom:33%;" />
</li>
<li><p>运行UdpClient类，点击右上角运行按钮，弹出客户端Swing界面</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009162503752.png" alt="image-20231009162503752" style="zoom:33%;" />

<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009162542138.png" alt="image-20231009162542138" style="zoom:33%;" />
</li>
<li><p>点击连接，在文本框输入HelloWorld并点击发送，客户端接收区显示发送文本</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009162706168.png" alt="image-20231009162706168" style="zoom:33%;" />

<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009162808554.png" alt="image-20231009162808554" style="zoom:33%;" />

<p>UdpServer控制台显示收到客户端请求数据“Hello World”，实验成功！</p>
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h2 id="实验结论"><a href="#实验结论" class="headerlink" title="实验结论"></a>实验结论</h2><ol>
<li><p>与TCP面向连接通信不同，UDP不需要在通信前建立连接，显得更加轻量、灵活，适用于那些对实时性要求较高，可以容忍一定数据丢失的场景。</p>
</li>
<li><p>UDP编程更加简洁明了，send()方法用于发送，receive()方法用于接收。</p>
</li>
<li><p>Socket接口类中已经实现了UDP协议相关的一些对象，它提供了创建、传输数据和管理端口的功能，使得程序能够在网络上进行有效的数据交换。</p>
</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-25T07:44:44.000Z" title="2023/10/25 15:44:44">2023-10-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-10-25T08:01:05.219Z" title="2023/10/25 16:01:05">2023-10-25</time></span><span class="level-item">9 minutes read (About 1417 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/25/TCPLab/">TCPLab</a></p><div class="content"><h1 id="TCP协议与并发服务编程实验"><a href="#TCP协议与并发服务编程实验" class="headerlink" title="TCP协议与并发服务编程实验"></a>TCP协议与并发服务编程实验</h1><h5 id="实验时间：2023-10-8"><a href="#实验时间：2023-10-8" class="headerlink" title="实验时间：2023.10.8"></a>实验时间：2023.10.8</h5><h2 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h2><p>本实验旨在利用Socket编写一个基于TCP协议的程序，实现即时通信，并且能够并发访问。具体目标如下：</p>
<ol>
<li>掌握利用Socket编写基于TCP协议的程序的方法，基本架构等。</li>
<li>学习面向连接通信方式，并与无连接通信方式进行对比学习。</li>
<li>理解并发服务的实现原理及过程。</li>
</ol>
<h2 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h2><p>TCP服务器采用并发服务能力，允许同时处理多个客户端的请求。这使得服务器可以同时与多个客户端建立会话，提高了服务器的性能和效率。</p>
<p>并发服务器程序通常由两部分组成。</p>
<ul>
<li><strong>主进程：</strong> 负责请求调度，接收客户端请求，并为每个请求创建一个服务处理线程。</li>
<li><strong>服务处理线程：</strong> 负责具体的会话处理，为客户请求提供服务。服务处理线程可以被主进程不断创建。</li>
</ul>
<p> 并发处理的数量理论上没有限制，主要取决于计算机的处理能力，包括CPU核数量和内存大小。如果同时有N个客户访问服务器，就有N＋1个线程在运行。</p>
<p>TCP通信流程图如下：</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009165649285.png" alt="image-20231009165649285" style="zoom:50%;" />

<p>在流程图中，TCPClient类实现了客户机，MainServer类实现了服务器主进程，ServiceServer实现了服务线程，承担实际服务处理。客户机通过端口号5588访问服务器，而客户机端口由系统自动赋予。<strong>实验时必须首先启动主进程服务器。</strong>ServerSocket类代表TCP协议对象，包含TCP端口的属性，主要方法<code>accept()</code>接受客户创建Socket会话对象；Socket类代表TCP会话对象，主要方法<code>getInputstream()</code>和<code>getOutputstream()</code>分别用于应用数据流的接收和发送，<code>close()</code>方法关闭会话。</p>
<ol>
<li><p>MainServer类，负责接收会话请求并创建服务线程</p>
<ul>
<li><p>创建Socket，使用Java提供的ServerSocket，提供端口号</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ServerSocket</span> <span class="variable">server</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">5588</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>等待会话请求，一旦成功便创建会话对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Socket</span> <span class="variable">client</span> <span class="operator">=</span> server.accept();</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建ServieServer服务线程，传递会话对象并启动线程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ServiceServer</span> <span class="variable">service</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServiceServer</span>(client);</span><br><span class="line">Thread thread=<span class="keyword">new</span> <span class="title class_">Thread</span>(service);</span><br><span class="line">thread.start();</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>ServiceServer类，需要实现Runnable线程接口</p>
<ul>
<li><p>从会话对象获取数据流，发送是输出流，接收是输入流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ServiceServer</span><span class="params">(Socket c)</span><span class="keyword">throws</span> IOException&#123;</span><br><span class="line">		<span class="built_in">this</span>.client=c;</span><br><span class="line">		is=<span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(client.getInputStream());</span><br><span class="line">		os=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(client.getOutputStream());</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>利用输入输出流进行数据交换</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">		Object obj=is.readObject();</span><br><span class="line">		<span class="keyword">if</span> (obj <span class="keyword">instanceof</span> User)&#123;</span><br><span class="line">			user=(User)obj;</span><br><span class="line">			System.out.println(<span class="string">&quot;--User:&quot;</span>+user.getUserID());</span><br><span class="line">			os.writeObject(obj);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(client</span><br><span class="line">				.getInputStream()));</span><br><span class="line">		out = <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(client.getOutputStream());</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭会话对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">in.close();</span><br><span class="line">out.close();</span><br><span class="line">client.close();</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>TCPClient类，作为客户端程序</p>
<ul>
<li><p>请求同服务端建立会话，指定服务器地址和端口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serviceSocket = <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="built_in">this</span>.txtFieldIP.getText(), <span class="number">5588</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>从会话对象获得数据流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">out = <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(serviceSocket.getOutputStream());</span><br><span class="line"> in = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(serviceSocket</span><br><span class="line">     .getInputStream()));</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭会话对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serviceSocket.close();</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试控制程序，创建两个客户程序检验并发服务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="type">TcpClient</span> <span class="variable">client1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TcpClient</span>(<span class="string">&quot;Jin&quot;</span>);</span><br><span class="line">		client1.pack();</span><br><span class="line">		client1.setSize(<span class="number">400</span>, <span class="number">360</span>);</span><br><span class="line">		client1.setVisible(<span class="literal">true</span>);</span><br><span class="line">		<span class="type">TcpClient</span> <span class="variable">client2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TcpClient</span>(<span class="string">&quot;zhang&quot;</span>);</span><br><span class="line">		client2.pack();</span><br><span class="line">		client2.setSize(<span class="number">400</span>, <span class="number">360</span>);</span><br><span class="line">		client2.setVisible(<span class="literal">true</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="实验环境"><a href="#实验环境" class="headerlink" title="实验环境"></a>实验环境</h2><h4 id="实验地点："><a href="#实验地点：" class="headerlink" title="实验地点："></a>实验地点：</h4><p>​	济事楼330机房</p>
<h4 id="实验设备："><a href="#实验设备：" class="headerlink" title="实验设备："></a>实验设备：</h4><p>​	PC一台，IntelliJ IDEA IDE</p>
<h2 id="实验内容"><a href="#实验内容" class="headerlink" title="实验内容"></a>实验内容</h2><ol>
<li>实现客户端和服务端编程，客户端为TCPClient类，服务端为MainServer和ServiceServer两个类</li>
<li>进行实时通信测试交互。先运行MainServer类，再运行TCPClient类，此时将连续创建两个客户端进程同时访问服务器。在客户端界面中输入要发送的字符串信息，在服务端观察接收，实现即时通信。</li>
</ol>
<h2 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h2><p>运行IntelliJ IDEA，创建Socket项目。</p>
<ol>
<li><p>在main&#x2F;src&#x2F;java下创建软件包<code>edu.tongji.sc.network.socket</code></p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009172230962.png" alt="image-20231009172230962" style="zoom:33%;" />
</li>
<li><p>在软件包中创建Java类<code>User</code>,这是一个数据类代表用户对象，是辅助类</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009172505056.png" alt="image-20231009172505056" style="zoom:33%;" />
</li>
<li><p>输入User类代码，用服务器下文件完全覆盖并保存编译。</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009172604091.png" alt="image-20231009172604091" style="zoom:33%;" />
</li>
<li><p>重复步骤2和3，分别创建TCPClient、ServiceServer、MainServer三个类。</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009173000080.png" alt="image-20231009173000080" style="zoom:33%;" />
</li>
<li><p>运行测试实验。</p>
<ul>
<li><p>运行MainServer，点击右上角运行按钮</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009173202934.png" alt="image-20231009173202934" style="zoom:33%;" />

<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009173418605.png" alt="image-20231009173418605" style="zoom:33%;" />
</li>
<li><p>运行TcpClient，点击右上角运行按钮，出现两个窗口；分别点击连接，MainServer控制台输出连接消息</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009173316430.png" alt="image-20231009173316430" style="zoom:33%;" />

<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009173636397.png" alt="image-20231009173636397" style="zoom:33%;" />

<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009173654679.png" alt="image-20231009173654679" style="zoom:33%;" />

<ul>
<li><p>在两个客户端接收区分别输入hello和world，MainServer控制台显示处理请求过程，实验成功</p>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009174030244.png" alt="image-20231009174030244" style="zoom:33%;" /></li>
</ul>
<img src="/Users/apple/Library/Application Support/typora-user-images/image-20231009174051191.png" alt="image-20231009174051191" style="zoom:33%;" /></li>
</ul>
</li>
</ol>
<h2 id="实验结论"><a href="#实验结论" class="headerlink" title="实验结论"></a>实验结论</h2><ol>
<li>与无连接通信方式相比，TCP提供了更多的保障，包括错误检测、流量控制等功能，因此TCP适用于那些对数据完整性和可靠性要求较高的场景，更加可靠而有序。</li>
<li>通过在服务端采用多线程的并发模型，为每个客户端连接创建一个独立的线程便可以实现并发服务。这样，每个客户端都能够在独立的线程中执行，互不干扰。</li>
<li>TCP程序采用了并发处理的架构，包括主进程（MainServer）和服务处理线程（ServiceServer）。主进程负责接收客户端请求并创建服务线程，而服务线程则负责具体的会话处理。</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-25T07:40:03.000Z" title="2023/10/25 15:40:03">2023-10-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-10-25T08:00:44.668Z" title="2023/10/25 16:00:44">2023-10-25</time></span><span class="level-item"><a class="link-muted" href="/categories/MicroService/">MicroService</a></span><span class="level-item">15 minutes read (About 2199 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/25/imageGenerator/">imageGenerator</a></p><div class="content"><h1 id="歌词-台词图像生成应用"><a href="#歌词-台词图像生成应用" class="headerlink" title="歌词-台词图像生成应用"></a><strong>歌词-台词图像生成应用</strong></h1><h2 id="一、项目简介"><a href="#一、项目简介" class="headerlink" title="一、项目简介"></a>一、项目简介</h2><p>​        在当前的数字化时代，随着互联网技术、人工智能模型的不断发展，个性化体验和创意分享已经成为网络文化不可或缺的组成部分。AIGC成为炙手可热的话题,为人们的网络使用体验注入新活力.人们不再满足于被动接受信息，而是更加注重个性化的表达和创意的分享。本应用致力于创建一个简单易用的平台，让用户能够轻松搜索音乐歌词和影视中的台词，并且从中挑选出自己喜欢的歌词或台词进行图像生成。</p>
<p>​        通过本应用，用户可以轻松分享自己的感受，通过可视化的方式表达自己关于某些文字的情感和态度。本应用在满足用户对个性化创意追求的同时，也为用户提供了一个丰富多彩的网络文化体验,感受AIGC带来的新奇体验。</p>
<h2 id="二、配置和部署说明"><a href="#二、配置和部署说明" class="headerlink" title="二、配置和部署说明"></a>二、配置和部署说明</h2><h3 id="2-1配置情况"><a href="#2-1配置情况" class="headerlink" title="2.1配置情况"></a>2.1配置情况</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Node.js<span class="punctuation">:</span>v18<span class="number">.15</span><span class="number">.0</span></span><br><span class="line"><span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@element-plus/icons-vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;axios&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.5.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;core-js&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.8.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;element-plus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.3.14&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;openai&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.12.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.2.13&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vue-router&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.2.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vuex&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.1.0&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>



<h3 id="2-2部署说明"><a href="#2-2部署说明" class="headerlink" title="2.2部署说明"></a>2.2部署说明</h3><p>本项目使用Ngnix部署到服务器<strong>47.96.30.31</strong>上,浏览器输入<a target="_blank" rel="noopener" href="http://47.96.30.31/%E5%8D%B3%E5%8F%AF%E8%AE%BF%E9%97%AE">http://47.96.30.31/即可访问</a>.</p>
<p>服务器为阿里云平台云服务器ECS,基本配置为:</p>
<p><img src="file:////Users/apple/Library/Containers/com.kingsoft.wpsoffice.mac/Data/tmp/wps-apple/ksohtml//wps1.jpg" alt="img"> </p>
<p><img src="file:////Users/apple/Library/Containers/com.kingsoft.wpsoffice.mac/Data/tmp/wps-apple/ksohtml//wps2.jpg" alt="img"> </p>
<h2 id="三、应用功能"><a href="#三、应用功能" class="headerlink" title="三、应用功能"></a>三、应用功能</h2><h3 id="1-歌曲-电影台词搜索"><a href="#1-歌曲-电影台词搜索" class="headerlink" title="1.歌曲&#x2F;电影台词搜索"></a>1.歌曲&#x2F;电影台词搜索</h3><p>用户可以通过关键词搜索他们喜欢的歌曲、歌手或影视，以便在平台上进行后续操作。在菜单栏进行目标切换.</p>
<p><img src="file:////Users/apple/Library/Containers/com.kingsoft.wpsoffice.mac/Data/tmp/wps-apple/ksohtml//wps3.jpg" alt="img"> </p>
<p><img src="file:////Users/apple/Library/Containers/com.kingsoft.wpsoffice.mac/Data/tmp/wps-apple/ksohtml//wps4.jpg" alt="img"> </p>
<p><img src="file:////Users/apple/Library/Containers/com.kingsoft.wpsoffice.mac/Data/tmp/wps-apple/ksohtml//wps5.jpg" alt="img"> </p>
<h3 id="2-文字选择"><a href="#2-文字选择" class="headerlink" title="2.文字选择"></a>2.文字选择</h3><p>用户可以从详情页面中选择自己喜欢的歌词或台词，进而进行图像生成。</p>
<p><img src="file:////Users/apple/Library/Containers/com.kingsoft.wpsoffice.mac/Data/tmp/wps-apple/ksohtml//wps6.jpg" alt="img"> </p>
<h3 id="4-自然语言处理"><a href="#4-自然语言处理" class="headerlink" title="4.自然语言处理"></a>4.自然语言处理</h3><p>利用ChatGPT接口，将用户选择的歌词&#x2F;台词转换成适合创作的关键词提供给作画api。</p>
<p><img src="file:////Users/apple/Library/Containers/com.kingsoft.wpsoffice.mac/Data/tmp/wps-apple/ksohtml//wps7.jpg" alt="img"> </p>
<h3 id="5-多接口整合"><a href="#5-多接口整合" class="headerlink" title="5.多接口整合"></a>5.多接口整合</h3><p>整合音乐API，以获取歌曲、歌词等信息，整合影视API，以获取影视经典台词，同时调用、chatGPT、stable Diffusion等api，实现图像生成。</p>
<h2 id="四、应用实现"><a href="#四、应用实现" class="headerlink" title="四、应用实现"></a>四、应用实现</h2><h3 id="1-前端结构"><a href="#1-前端结构" class="headerlink" title="1.前端结构"></a>1.前端结构</h3><p>src文件夹下路径结构:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── App.vue</span><br><span class="line">├── assets</span><br><span class="line">│   └── logo.png</span><br><span class="line">├── components</span><br><span class="line">│   ├── firstPageTwo.vue</span><br><span class="line">│   ├── fourthPage.vue</span><br><span class="line">│   ├── fourthPageLines.vue</span><br><span class="line">│   ├── myNavTwo.vue</span><br><span class="line">│   ├── secondPage.vue</span><br><span class="line">│   ├── secondPageLines.vue</span><br><span class="line">│   ├── thirdPage.vue</span><br><span class="line">│   └── thirdPageLines.vue</span><br><span class="line">├── main.js</span><br><span class="line">├── router</span><br><span class="line">│   └── index.js</span><br><span class="line">└── store</span><br><span class="line">    └── index.js</span><br></pre></td></tr></table></figure>

<p> 其中:</p>
<p>App.vue文件是整个应用的布局,使用el-container容器,包裹el-header(导航栏)、el-main(页面主体内容)、el-footer(页面底部),其中el-main中为router-view,根据路由展示不同组件.</p>
<p>components目录包括了应用的各个组件,包括:导航栏内容、首页内容、搜索页面结果(音乐&#x2F;媒体)、详情页面(音乐&#x2F;媒体)、绘图展示页面(音乐&#x2F;媒体).</p>
<p>图片等资源文件存放在与src文件夹同级的public目录下.</p>
<p>router目录下存放路由配置,store目录下存放容器,保存用户选择状态–音乐或者影视.</p>
<h3 id="2-api调用"><a href="#2-api调用" class="headerlink" title="2.api调用"></a>2.api调用</h3><h4 id="1-搜索结果"><a href="#1-搜索结果" class="headerlink" title="(1)搜索结果"></a>(1)搜索结果</h4><p>​        在组件实例创建之前调用onMounted函数,使用首页传递来的queryString向音乐&#x2F;影视网站发出GET请求,获取所需信息:音乐方面包括歌曲名、艺人名、照片、ID;影视方面包括名字、类型、图片、年份、ID等信息,存入数组中并展示.</p>
<p>以音乐的js代码为例:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; onMounted,ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> queryString=<span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> topThreeSongsArray=<span class="title function_">ref</span>([])</span><br><span class="line"><span class="keyword">const</span> topThreeSingerArray=<span class="title function_">ref</span>([])</span><br><span class="line"><span class="keyword">const</span> topThreeImageArray=<span class="title function_">ref</span>([])</span><br><span class="line"><span class="keyword">const</span> topThreeIdArray=<span class="title function_">ref</span>([])</span><br><span class="line"><span class="comment">//跳转到歌词页面</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getLyrics</span> = (<span class="params">index</span>) =&gt; &#123;</span><br><span class="line">  router.<span class="title function_">push</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/thirdPage&#x27;</span>, <span class="attr">query</span>: &#123; <span class="attr">queryString</span>: topThreeIdArray.<span class="property">value</span>[index-<span class="number">1</span>] &#125;&#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//获取搜索结果</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getResults</span>=<span class="keyword">async</span>(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(queryString)</span><br><span class="line">    <span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> options = &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;https://genius-song-lyrics1.p.rapidapi.com/search/&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">        <span class="attr">q</span>: queryString.<span class="property">value</span>,</span><br><span class="line">        <span class="attr">per_page</span>: <span class="string">&#x27;10&#x27;</span>,</span><br><span class="line">        <span class="attr">page</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;X-RapidAPI-Key&#x27;</span>: <span class="string">&#x27;e5b6cf43b5msh082c9a6af43d8c7p10b48cjsn744f05e11812&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;X-RapidAPI-Host&#x27;</span>: <span class="string">&#x27;genius-song-lyrics1.p.rapidapi.com&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">request</span>(options);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">data</span>);</span><br><span class="line">        <span class="keyword">const</span> topThreeSongs2 = response.<span class="property">data</span>.<span class="property">hits</span>.<span class="title function_">slice</span>(<span class="number">0</span>,<span class="number">9</span>).<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">title</span>: item.<span class="property">result</span>.<span class="property">title</span>,</span><br><span class="line">            <span class="attr">artist</span>: item.<span class="property">result</span>.<span class="property">primary_artist</span>.<span class="property">name</span>,</span><br><span class="line">            <span class="attr">albumImage</span>: item.<span class="property">result</span>.<span class="property">song_art_image_url</span>,</span><br><span class="line">            <span class="attr">id</span>:item.<span class="property">result</span>.<span class="property">id</span></span><br><span class="line">        &#125;;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;topThreeSongs2.<span class="property">length</span>;i++)&#123;</span><br><span class="line">            topThreeSongsArray.<span class="property">value</span>.<span class="title function_">push</span>(topThreeSongs2[i].<span class="property">title</span>)</span><br><span class="line">            topThreeSingerArray.<span class="property">value</span>.<span class="title function_">push</span>(topThreeSongs2[i].<span class="property">artist</span>)</span><br><span class="line">            topThreeImageArray.<span class="property">value</span>.<span class="title function_">push</span>(topThreeSongs2[i].<span class="property">albumImage</span>)</span><br><span class="line">            topThreeIdArray.<span class="property">value</span>.<span class="title function_">push</span>(topThreeSongs2[i].<span class="property">id</span>)</span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 从路由的 query 参数中获取</span></span><br><span class="line">  queryString.<span class="property">value</span> = router.<span class="property">currentRoute</span>.<span class="property">value</span>.<span class="property">query</span>.<span class="property">queryString</span>;</span><br><span class="line">  <span class="title function_">getResults</span>();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2-详情展示"><a href="#2-详情展示" class="headerlink" title="(2)详情展示"></a>(2)详情展示</h4><p>​        用户在结果页点击获取详情,跳转至详情页;在组件实例创建之前调用onMounted函数,使用搜索结果页传递来的ID获取详细信息:音乐方面包括歌名、歌手图片、歌手名称、专辑图片、专辑名称、发行日期,以及获取全部歌词;影视方面包括名称、类型、图片、日期、种类、大体情节,以及经典台词.</p>
<p>以音乐的js为例:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; onMounted,ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Upload</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@element-plus/icons-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>,<span class="title class_">ElLoading</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">OpenAI</span> <span class="keyword">from</span> <span class="string">&quot;openai&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>();</span><br><span class="line"><span class="keyword">const</span> selectedLyrics=<span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> queryString=<span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> songTitle=<span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> artistName = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> albumTitle  =<span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> releaseDate = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> albumImage  =<span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> singerImage  =<span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> fullLyrics=<span class="title function_">ref</span>()</span><br><span class="line"><span class="comment">//获取歌曲详情</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getSongDetail</span>=<span class="keyword">async</span>(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> options = &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;https://genius-song-lyrics1.p.rapidapi.com/song/details/&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;<span class="attr">id</span>: queryString.<span class="property">value</span>&#125;,</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;X-RapidAPI-Key&#x27;</span>: <span class="string">&#x27;e5b6cf43b5msh082c9a6af43d8c7p10b48cjsn744f05e11812&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;X-RapidAPI-Host&#x27;</span>: <span class="string">&#x27;genius-song-lyrics1.p.rapidapi.com&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">request</span>(options);</span><br><span class="line">        songTitle.<span class="property">value</span>=response.<span class="property">data</span>.<span class="property">song</span>.<span class="property">title</span>;</span><br><span class="line">        albumTitle.<span class="property">value</span>=response.<span class="property">data</span>.<span class="property">song</span>.<span class="property">album</span>.<span class="property">name</span>;</span><br><span class="line">        artistName.<span class="property">value</span>=response.<span class="property">data</span>.<span class="property">song</span>.<span class="property">primary_artist</span>.<span class="property">name</span>;</span><br><span class="line">        releaseDate.<span class="property">value</span>=response.<span class="property">data</span>.<span class="property">song</span>.<span class="property">release_date_for_display</span>;</span><br><span class="line">        albumImage.<span class="property">value</span>=response.<span class="property">data</span>.<span class="property">song</span>.<span class="property">album</span>.<span class="property">cover_art_url</span>;</span><br><span class="line">        singerImage.<span class="property">value</span>=response.<span class="property">data</span>.<span class="property">song</span>.<span class="property">primary_artist</span>.<span class="property">image_url</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">data</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//获取歌词</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getSongLyrics</span>=<span class="keyword">async</span>(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> options = &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;https://genius-song-lyrics1.p.rapidapi.com/song/lyrics/&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;<span class="attr">id</span>: queryString.<span class="property">value</span>&#125;,</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;X-RapidAPI-Key&#x27;</span>: <span class="string">&#x27;e5b6cf43b5msh082c9a6af43d8c7p10b48cjsn744f05e11812&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;X-RapidAPI-Host&#x27;</span>: <span class="string">&#x27;genius-song-lyrics1.p.rapidapi.com&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">request</span>(options);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">data</span>);</span><br><span class="line">        fullLyrics.<span class="property">value</span>=response.<span class="property">data</span>.<span class="property">lyrics</span>.<span class="property">lyrics</span>.<span class="property">body</span>.<span class="property">html</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 从路由的 query 参数中获取</span></span><br><span class="line">  queryString.<span class="property">value</span> = router.<span class="property">currentRoute</span>.<span class="property">value</span>.<span class="property">query</span>.<span class="property">queryString</span>;</span><br><span class="line">  <span class="title function_">getSongDetail</span>();</span><br><span class="line">  <span class="title function_">getSongLyrics</span>();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h4 id="3-生成图片"><a href="#3-生成图片" class="headerlink" title="(3)生成图片"></a>(3)生成图片</h4><p>​        点击generate按钮后,首先将文本框内的内容作为content,使用OpenAI接口,让其返回10个prompts;接着,使用这10个prompts调用stable Diffusion的api,让其生成图片,得到最终图片的url,并传递给最后的页面.</p>
<p>以音乐的js为例:</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">generateImage</span>=<span class="keyword">async</span>(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="title class_">ElMessage</span>(&#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;Please be patient,your image is being painted...&#x27;</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line">    <span class="comment">//获取prompts</span></span><br><span class="line">    <span class="keyword">const</span> openai = <span class="keyword">new</span> <span class="title class_">OpenAI</span>(&#123;</span><br><span class="line">  <span class="attr">apiKey</span>: <span class="string">&quot;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&quot;</span>,</span><br><span class="line">  <span class="attr">dangerouslyAllowBrowser</span>:<span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line">   </span><br><span class="line">    selectedLyrics.<span class="property">value</span> = <span class="string">&quot;I will give you some sentences, and you just give me 10 key words for all sentences in total.Don&#x27;t give me anything else,just 10 key words.&quot;</span> + selectedLyrics.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> openai.<span class="property">chat</span>.<span class="property">completions</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">model</span>: <span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    <span class="attr">messages</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">        <span class="string">&quot;content&quot;</span>: selectedLyrics.<span class="property">value</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">temperature</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">max_tokens</span>: <span class="number">256</span>,</span><br><span class="line">    <span class="attr">top_p</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">frequency_penalty</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">presence_penalty</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">choices</span>[<span class="number">0</span>].<span class="property">message</span>.<span class="property">content</span>);</span><br><span class="line">        resultPrompts.<span class="property">value</span>=response.<span class="property">choices</span>[<span class="number">0</span>].<span class="property">message</span>.<span class="property">content</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> resultpromptsValue = resultPrompts.<span class="property">value</span> || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    resultpromptsValue+=<span class="string">&#x27;11.masterpiece&#x27;</span></span><br><span class="line">    resultPrompts.<span class="property">value</span>=resultpromptsValue</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(resultPrompts.<span class="property">value</span>)</span><br><span class="line">    printedResultPrompts.<span class="property">value</span>=resultPrompts.<span class="property">value</span>.<span class="title function_">replace</span>(<span class="string">&#x27;11.masterpiece&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(printedResultPrompts.<span class="property">value</span>)</span><br><span class="line">    <span class="comment">//获取生成图片任务的uid</span></span><br><span class="line"><span class="keyword">const</span> requestInfo = &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;https://23329.o.apispace.com/aigc/txt2img&quot;</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123;</span><br><span class="line">    <span class="string">&quot;X-APISpace-Token&quot;</span>: <span class="string">&quot;8qdtf7fect98p1dzkkath5hw5ju5ow1e&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Authorization-Type&quot;</span>: <span class="string">&quot;apikey&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">task</span>: <span class="string">&quot;txt2img.sd&quot;</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;</span><br><span class="line">      <span class="attr">model</span>: <span class="string">&quot;anime&quot;</span>,</span><br><span class="line">      <span class="attr">text</span>:resultPrompts.<span class="property">value</span>,</span><br><span class="line">      <span class="attr">w</span>: <span class="number">750</span>,</span><br><span class="line">      <span class="attr">h</span>: <span class="number">512</span>,</span><br><span class="line">      <span class="attr">guidance_scale</span>: <span class="number">14</span>,</span><br><span class="line">      <span class="attr">negative_prompt</span>: <span class="string">&quot;cropped, blurred, mutated, error, lowres, blurry, low quality, username, signature, watermark, text, nsfw, missing limb, fused hand, missing hand, extra limbs, malformed limbs, bad hands, extra fingers, fused fingers, missing fingers, bad breasts, deformed, mutilated, morbid, bad anatomy&quot;</span>,</span><br><span class="line">      <span class="attr">sampler</span>: <span class="string">&quot;k_euler&quot;</span>,</span><br><span class="line">      <span class="attr">seed</span>: <span class="number">1072366942</span>,</span><br><span class="line">      <span class="attr">num_steps</span>: <span class="number">25</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">model</span>: <span class="string">&quot;anime&quot;</span>,</span><br><span class="line">    <span class="attr">text</span>:</span><br><span class="line">      resultPrompts.<span class="property">value</span>,</span><br><span class="line">      <span class="attr">w</span>: <span class="number">750</span>,</span><br><span class="line">      <span class="attr">h</span>: <span class="number">512</span>,</span><br><span class="line">      <span class="attr">guidance_scale</span>: <span class="number">14</span>,</span><br><span class="line">      <span class="attr">negative_prompt</span>: <span class="string">&quot;cropped, blurred, mutated, error, lowres, blurry, low quality, username, signature, watermark, text, nsfw, missing limb, fused hand, missing hand, extra limbs, malformed limbs, bad hands, extra fingers, fused fingers, missing fingers, bad breasts, deformed, mutilated, morbid, bad anatomy&quot;</span>,</span><br><span class="line">      <span class="attr">sampler</span>: <span class="string">&quot;k_euler&quot;</span>,</span><br><span class="line">      <span class="attr">seed</span>: <span class="number">1072366942</span>,</span><br><span class="line">      <span class="attr">num_steps</span>: <span class="number">25</span>,</span><br><span class="line">      <span class="attr">notify_url</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response2 = <span class="keyword">await</span> axios.<span class="title function_">request</span>(requestInfo);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(response2)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(response2.<span class="property">data</span>.<span class="property">data</span>.<span class="property">uid</span>);</span><br><span class="line">        <span class="keyword">const</span> resultuid=response2.<span class="property">data</span>.<span class="property">data</span>.<span class="property">uid</span></span><br><span class="line">        resultUid.<span class="property">value</span>=resultuid</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//加载组件</span></span><br><span class="line">    <span class="keyword">const</span> loading = <span class="title class_">ElLoading</span>.<span class="title function_">service</span>(&#123;</span><br><span class="line">        <span class="attr">lock</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">text</span>: <span class="string">&#x27;Painting&#x27;</span>,</span><br><span class="line">        <span class="attr">background</span>: <span class="string">&#x27;rgba(255, 255, 255, 0.5)&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        loading.<span class="title function_">close</span>()</span><br><span class="line">    &#125;, <span class="number">10000</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//延迟10秒获取url</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="title function_">async</span>()=&gt;&#123;</span><br><span class="line">        <span class="keyword">const</span> requestInfo2 = &#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&quot;https://23329.o.apispace.com/aigc/query-image&quot;</span>,</span><br><span class="line">        <span class="attr">headers</span>: &#123;</span><br><span class="line">            <span class="string">&quot;X-APISpace-Token&quot;</span>: <span class="string">&quot;8qdtf7fect98p1dzkkath5hw5ju5ow1e&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Authorization-Type&quot;</span>: <span class="string">&quot;apikey&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">data</span>: &#123;</span><br><span class="line">            <span class="attr">uid</span>: resultUid.<span class="property">value</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> response3 = <span class="keyword">await</span> axios.<span class="title function_">request</span>(requestInfo2);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(response3)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(response3.<span class="property">data</span>.<span class="property">data</span>.<span class="property">cdn</span>);</span><br><span class="line">            <span class="keyword">const</span> resulturl=response3.<span class="property">data</span>.<span class="property">data</span>.<span class="property">cdn</span></span><br><span class="line">            resultUrl.<span class="property">value</span>=resulturl</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        finalQueryString.<span class="property">value</span>=resultUrl.<span class="property">value</span>+<span class="string">&#x27;+&#x27;</span>+printedResultPrompts.<span class="property">value</span></span><br><span class="line">        router.<span class="title function_">push</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/fourthPage&#x27;</span>, <span class="attr">query</span>: &#123; <span class="attr">finalQueryString</span>: finalQueryString.<span class="property">value</span> &#125;&#125;)</span><br><span class="line">    &#125;,<span class="number">10000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="五、Web-API文档"><a href="#五、Web-API文档" class="headerlink" title="五、Web API文档"></a>五、Web API文档</h2><p><strong>Apifox接口文档(已整合):</strong></p>
<p><strong><a target="_blank" rel="noopener" href="https://apifox.com/apidoc/shared-a527c342-822e-4ab2-8ecd-05c76645b34a/api-119010480">https://apifox.com/apidoc/shared-a527c342-822e-4ab2-8ecd-05c76645b34a/api-119010480</a></strong></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-25T07:18:11.000Z" title="2023/10/25 15:18:11">2023-10-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-10-25T07:22:20.707Z" title="2023/10/25 15:22:20">2023-10-25</time></span><span class="level-item">a few seconds read (About 16 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/25/MyFirstBlog/">MyFirstBlog</a></p><div class="content"><h3 id="KGAT"><a href="#KGAT" class="headerlink" title="KGAT"></a>KGAT</h3><p>知识图谱与图神经网络注意力机制</p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.svg" alt="CharlotteYang"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">CharlotteYang</p><p class="is-size-6 is-block">Be happy😊</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Shanghai</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Category</p><a href="/categories"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">2</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/llRagdoll" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/llRagdoll"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/MicroService/"><span class="level-start"><span class="level-item">MicroService</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/research/"><span class="tag">research</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/study/"><span class="tag">study</span><span class="tag">5</span></a></div></div></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://47.96.30.31" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ImageGenerator</span></span><span class="level-right"><span class="level-item tag">47.96.30.31</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-25T07:47:05.000Z">2023-10-25</time></p><p class="title"><a href="/2023/10/25/dataExamineLab/">dataExamineLab</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-25T07:46:34.000Z">2023-10-25</time></p><p class="title"><a href="/2023/10/25/EthernetLab/">EthernetLab</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-25T07:44:58.000Z">2023-10-25</time></p><p class="title"><a href="/2023/10/25/UDPLab/">UDPLab</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-25T07:44:44.000Z">2023-10-25</time></p><p class="title"><a href="/2023/10/25/TCPLab/">TCPLab</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-25T07:40:03.000Z">2023-10-25</time></p><p class="title"><a href="/2023/10/25/imageGenerator/">imageGenerator</a></p><p class="categories"><a href="/categories/MicroService/">MicroService</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Little Sheeeeep" height="28"></a><p class="is-size-7"><span>&copy; 2023 Charlotte Yang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2023</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/llRagdoll"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>